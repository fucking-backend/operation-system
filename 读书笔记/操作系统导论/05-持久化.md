## 持久化

### IO设备

分层架构：根据设备性能高低，编排设备。

标准设备：分为硬件接口（寄存器：状态，命令，数据），内部结构

标准协议：

    （1）轮询设备
    （2）OS下发数据到数据寄存器
    （3）OS将命令写入命令寄存器
    （4）OS进行设备轮询

利用中断减少CPU轮询开销：设备完成自身操作，会抛出一个硬件中断，引发CPU跳转执行操作系统预先定义好的中断服务例程

中断并非总比PIO（编程的IO）好：

    （1）设备非常快。轮询反而更好
    （2）速度未知，时快时慢。先轮询，再使用中断
    （3）网络，可能引发活锁。
    （4）多次中断合并为一次中断

利用DMA（协调数据在内存和设备之间传输，不需要CPU介入）进行更高效的数据传输

设备交互的方法：

    （1）明确的IO指令
    （2）内存映射IO

纳入操作系统：设备驱动

question: 键盘敲入“A”字母时，操作系统期间发生了什么

### 磁盘驱动器

磁道，磁头，机械臂

磁盘延迟延迟：

    单慈道延迟：旋转延迟
    多磁道：寻道时间
    IO时间

磁道缓冲区。应该在数据放入内存之后（后写缓存），还是写入实际磁盘之后（直写），回报写入完成

### 磁盘调度

    （1）先来先服务
    （2）最短寻道时间优先，最短定位时间优先
    （3）SCAN电梯算法（一头走到一头），C-SCAN（改进版，返回的时候不处理）
    （4）LOOK走到最远的的请求（不是走到头），C-LOOK（改进版，返回的时候不处理）







